{"id":40,"date":"2023-01-28T02:28:01","date_gmt":"2023-01-28T01:28:01","guid":{"rendered":"http:\/\/localhost\/wordpress\/?p=40"},"modified":"2023-01-30T19:44:31","modified_gmt":"2023-01-30T18:44:31","slug":"modding-the-silver-case-part-2-extracting-repacking","status":"publish","type":"post","link":"http:\/\/localhost\/wordpress\/2023\/01\/28\/modding-the-silver-case-part-2-extracting-repacking\/","title":{"rendered":"Modding The Silver Case (Part 2): Extracting &#038; Repacking"},"content":{"rendered":"\n<p>Our <a href=\"http:\/\/localhost\/wordpress\/2023\/01\/26\/modding-the-silver-case-ps4-part-1-dumping-reinstalling\/\" data-type=\"post\" data-id=\"23\">previous <\/a>post explained how to prepare a game for modding. Today, it&#8217;s about time we do the actual modding part!<\/p>\n\n\n\n<p><\/p>\n\n\n\n<p>The game was made with <strong>Unity<\/strong>. As such, its mostly comprised of .assets files, just like the PC version, with one particularity: the heaviest (and most important) assets have been compressed within a <strong>.psarc<\/strong> archive, a proprietary format used by Sony games since the <em>PS3 <\/em>era.<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full is-resized\"><img decoding=\"async\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/EqA99JfXIAAxS2p.png\" alt=\"\" class=\"wp-image-45\" width=\"686\" height=\"373\"\/><\/figure><\/div>\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full is-resized\"><img decoding=\"async\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/EqA-SheXUAQCh0x.png\" alt=\"\" class=\"wp-image-46\" width=\"688\" height=\"433\"\/><figcaption class=\"wp-element-caption\"><em>General folder layout. The &#8220;Media&#8221; folder contains some .assets files, as well as a &#8220;StreamingAssets&#8221; folder which contains the game&#8217;s videos as .MP4s<\/em>.<\/figcaption><\/figure><\/div>\n\n\n<p><\/p>\n\n\n\n<p>In 2020, I used a tool named <strong><a href=\"https:\/\/github.com\/IcySon55\/Kuriimu\/releases\" data-type=\"URL\" data-id=\"https:\/\/github.com\/IcySon55\/Kuriimu\/releases\">Karameru<\/a> <\/strong>to extract the .<em>psarc<\/em> archives. This time I used <a href=\"http:\/\/richwhitehouse.com\/index.php?content=inc_projects.php&amp;showproject=91\"><strong>Noesis<\/strong><\/a>, a tool widely-used to preview 3D models from different formats, but also for extracting some types of archives, which <em>.psarc<\/em> is part of.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"1428\" height=\"632\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/Noesis64_yrB110L5Mw.png\" alt=\"\" class=\"wp-image-48\"\/><figcaption class=\"wp-element-caption\"><em>Right-clicking on the archive and selecting &#8220;Export&#8221; allows us to extract it wherever we want.<\/em><\/figcaption><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>Once the archive is extracted, we can treat its contents like a usual <em>Unity <\/em>game folder. Unfortunately, this means more extracting and repacking but it won&#8217;t be a problem, as this time we have the whole Unity modding community behind our back!<\/p>\n\n\n\n<p> My favorite tool for extracting <em>Unity .assets<\/em> files is <a href=\"https:\/\/github.com\/Perfare\/AssetStudio\" data-type=\"URL\" data-id=\"https:\/\/github.com\/Perfare\/AssetStudio\"><strong>AssetStudio<\/strong><\/a>, a software that has been faithful to me since 2019, when I first used it on the <em>PC <\/em>version of the game. It&#8217;s very easy of use for previewing and extracting the contents within the archives, but it unfortunately does not support reimporting\/repacking.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"1920\" height=\"1040\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/image.png\" alt=\"\" class=\"wp-image-51\"\/><figcaption class=\"wp-element-caption\"><em>When we use the &#8220;Load folder&#8221; option on our extracted archive, we can see all the TextAsset (JSON messages) and Texture2D (image textures) we need to replace. We can extract them by using the &#8220;Export&#8221; option<\/em>.<\/figcaption><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>Once the files we want are extracted, we can edit them to our leisure. I won&#8217;t elaborate much on this part, but one thing I can say is that <em>AssetStudio <\/em>does its best to convert the assets into commonly-used formats: <em>.txt\/.json<\/em> files for the <em>TextAsset <\/em>files, <em>.png<\/em> files for the <em>Texture2D<\/em> ones,  <em>.wav <\/em>for the <em>AudioClip<\/em>&#8230; Surely, we won&#8217;t have much research works to find software able to work with these file formats!<\/p>\n\n\n\n<p>Anyway, after editing the extracted filed to our will, we will reimport them with a russian tool called <strong><a href=\"https:\/\/www.dropbox.com\/s\/j0dyaqogc7w2gbn\/UnityEX_Advanced.rar\" data-type=\"URL\" data-id=\"https:\/\/www.dropbox.com\/s\/j0dyaqogc7w2gbn\/UnityEX_Advanced.rar\">UnityEX<\/a> <\/strong>(<a href=\"https:\/\/disk.yandex.ru\/d\/C7Vzo44UDXiq-w\" data-type=\"URL\" data-id=\"https:\/\/disk.yandex.ru\/d\/C7Vzo44UDXiq-w\">YandexDisk<\/a> mirror). Just like <em>AssetStudio<\/em>, it&#8217;s a tool I got familiar with in 2019, when I worked with the <em>PC <\/em>version. It has been helpful enough for me to donate to its developer in order to get all the features of the program, such as the <em>Unity <\/em>2020-2021 support (more on that on the official forum <a href=\"https:\/\/forum.zoneofgames.ru\/topic\/36240-unityex\/\" data-type=\"URL\" data-id=\"https:\/\/forum.zoneofgames.ru\/topic\/36240-unityex\/\">thread<\/a>), but we can work with the freeware version as well, since the game has been compiled with <em>Unity<\/em>&#8216;s 2016-2017 SDK!<\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img decoding=\"async\" width=\"883\" height=\"761\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/image-2.png\" alt=\"\" class=\"wp-image-53\"\/><figcaption class=\"wp-element-caption\"><em>UnityEX in action on the game&#8217;s &#8220;resources.assets&#8221; archive.<\/em><\/figcaption><\/figure><\/div>\n\n\n<p>Unlike <em>AssetStudio<\/em>, <em>UnityEX<\/em> only opens one file at a time, which doesn&#8217;t matter since all the content we need is stored within the <em>resources.assets<\/em> file. When we open an archive within UnityEX, we can extract the files by right-clicking them, then by pressing &#8220;Extract with convert or Raw&#8221;: this will convert a file to a more common extension if it&#8217;s known (like <em>AssetStudio<\/em> does), or leave it as-is. <\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full is-resized\"><img decoding=\"async\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/image-1.png\" alt=\"\" class=\"wp-image-52\" width=\"665\" height=\"695\"\/><figcaption class=\"wp-element-caption\"><em>The extracted files go to a new folder named &#8220;<em>Unity_Assets_Files<\/em>&#8220;, which will contain another folder bearing the same name as our <em>.assets<\/em> file, in this case <em>resources<\/em>.<\/em><\/figcaption><\/figure><\/div>\n\n\n<p>By hitting the &#8220;<em>Import all files&#8221;<\/em> button in <em>UnityEX<\/em>, the program will look all the files from the folder mentioned above, compare the filenames to the ones within the opened <em>.assets <\/em>archive, then replace each matching occurence. Any <em>.png<\/em> file is automatically converted into a <em>.tex Texture2D<\/em> file, then reinserted in the archive. If the program finds a filename that doesn&#8217;t correspond to anything in the archive, it will give a warning and askip if we want to continue anyway. <\/p>\n\n\n<div class=\"wp-block-image\">\n<figure class=\"aligncenter size-full\"><img decoding=\"async\" width=\"883\" height=\"761\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/image-3.png\" alt=\"\" class=\"wp-image-54\"\/><figcaption class=\"wp-element-caption\"><em>You might not see the difference, but the green bar being halfway through is a sign of the importing process being in progress.<\/em><\/figcaption><\/figure><\/div>\n\n\n<p>Now that the <em>resources.assets<\/em> has been edited, it&#8217;s time to do the whole process&#8230; Backwards! First, we need to  repack the folder containing the extracted <em>.assets<\/em> files back to a .psarc file. This time, instead of <em>Karameru<\/em>,  I used <a href=\"https:\/\/www.ghisler.com\/\">Total Commander<\/a>, a freeware file manager which had the benefit of supporting <em>.psarc <\/em>repacking thanks to a third-party <a href=\"http:\/\/totalcmd.net\/plugring\/PSARC.html\">plugin<\/a> by <em>BEKETATA<\/em>.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"569\" height=\"410\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/TOTALCMD64_5EmDLZpBdO.png\" alt=\"\" class=\"wp-image-55\"\/><figcaption class=\"wp-element-caption\"><em>Right-clicking on the folder, then clicking &#8220;File &gt; Pack&#8230;&#8221; does the trick.<\/em><\/figcaption><\/figure>\n\n\n\n<p><\/p>\n\n\n\n<p>And&#8230; that&#8217;s it! Now, we have our modded <em>archive.psarc<\/em> file, ready to get inserted back into the game. As there are multiple ways of doing that, which both take a fair amount of time and dedication, I will document them in a final post, one that will get more focused on the <em>PS4<\/em>-side manipulation than the <em>PC<\/em> one.<\/p>\n\n\n\n<figure class=\"wp-block-image size-full\"><img decoding=\"async\" width=\"603\" height=\"66\" src=\"http:\/\/localhost\/wordpress\/wp-content\/uploads\/2023\/01\/explorer_SMSLQwpTbO.png\" alt=\"\" class=\"wp-image-56\"\/><figcaption class=\"wp-element-caption\"><em>Our custom videos folder, as well as our modded archive, are ready to go. The archive_og.psarc file is a mere emergency backup.<\/em><\/figcaption><\/figure>\n","protected":false},"excerpt":{"rendered":"<p>In this post, I will explain how to work with the (not so) niche and proprietary .PSARC archive format, as well as the (even less) niche and proprietary Unity .assets archive format.<\/p>\n<div class=\"more-link-wrapper\"><a class=\"more-link\" href=\"http:\/\/localhost\/wordpress\/2023\/01\/28\/modding-the-silver-case-part-2-extracting-repacking\/\">Continue Reading<span class=\"screen-reader-text\">Modding The Silver Case (Part 2): Extracting &#038; Repacking<\/span> <i class=\"fas fa-angle-right\"><\/i><\/a><\/div>\n","protected":false},"author":1,"featured_media":42,"comment_status":"open","ping_status":"open","sticky":false,"template":"","format":"standard","meta":{"_import_markdown_pro_load_document_selector":0,"_import_markdown_pro_submit_text_textarea":""},"categories":[16,12],"tags":[10,7,8,14],"_links":{"self":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/40"}],"collection":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts"}],"about":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/types\/post"}],"author":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/users\/1"}],"replies":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/comments?post=40"}],"version-history":[{"count":12,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/40\/revisions"}],"predecessor-version":[{"id":68,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/posts\/40\/revisions\/68"}],"wp:featuredmedia":[{"embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media\/42"}],"wp:attachment":[{"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/media?parent=40"}],"wp:term":[{"taxonomy":"category","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/categories?post=40"},{"taxonomy":"post_tag","embeddable":true,"href":"http:\/\/localhost\/wordpress\/wp-json\/wp\/v2\/tags?post=40"}],"curies":[{"name":"wp","href":"https:\/\/api.w.org\/{rel}","templated":true}]}}